<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Generative Guitar Station</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* 新增：雨滴 Canvas 样式，覆盖全屏但不阻挡点击 */
        #rain-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1; /* 放在背景层 */
            pointer-events: none; /* 让鼠标事件穿透 */
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <!-- 新增 Canvas -->
    <canvas id="rain-canvas"></canvas>

    <div class="controls-top">
        <div class="control-group">
            <label>MODE / SCALE</label>
            <select id="scale-select">
                <!-- 动态生成 -->
            </select>
        </div>
        <div class="control-group">
            <label>TIME SIG</label>
            <select id="time-sig-select">
                <option value="4">4/4</option>
                <option value="3">3/4</option>
                <option value="6">6/8</option>
            </select>
        </div>
        <!-- 鼓组开关 -->
        <div class="control-group">
            <label>DRUMS</label>
            <input type="checkbox" id="drums-toggle">
        </div>
        <div class="control-group">
            <label>BPM: <span id="bpm-val">80</span></label>
            <input type="range" id="bpm-slider" min="40" max="160" value="80">
        </div>
        <!-- 新增：雨声开关 -->
        <div class="control-group">
            <label>Rain Ambience</label>
            <label class="switch">
                <input type="checkbox" id="rain-toggle">
                <span class="slider round"></span>
            </label>
        </div>
    </div>

    <div class="display-area" id="main-ui">
        <div class="chord-box">
            <h3>CURRENT CHORD</h3>
            <h1 id="chord-display">--</h1>
            <div id="chord-detail">Waiting...</div>
        </div>
        <div class="chord-box">
            <h3>MELODY NOTE</h3>
            <h1 id="note-display">--</h1>
        </div>
    </div>

    <button id="start-btn">Start Session</button>
    
    <div id="log"></div>

    <!-- 引入 Tone.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>

    <!-- 按顺序加载脚本 -->
    <script src="js/data.js"></script>
    <script src="js/synth.js"></script>
    <script src="js/nextnote.js"></script>
    <!-- 新增：视觉脚本 -->
    <script src="js/visuals.js"></script> 
    <script src="js/app.js"></script>
    <script src="js/worker.js"></script>
</body>
</html>